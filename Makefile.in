# $NetBSD: Makefile.in,v 1.8 2003/07/31 22:40:27 jschauma Exp $
#

srcdir	= @srcdir@
prefix	= @prefix@
VPATH	= @srcdir@
SHELL	= /bin/sh

CC	= @CC@
CFLAGS	= -I${srcdir} -I. @INCLUDES@ @CFLAGS@
CPPFLAGS= @CPPFLAGS@
DEFS	= @DEFS@
INSTALL	= @INSTALL@
LDFLAGS	= @LDFLAGS@

AR	= @AR@
RANLIB	= @RANLIB@

LIB	= libnbcompat.a

OBJS	= @LIBOBJS@ \
	md5c.o md5hl.o rmd160.o rmd160hl.o sha1.o sha1hl.o \
	sha2.o sha2hl.o unvis.o vis.o setmode.o __fts13.o \
	getid.o misc.o pack_dev.o spec.o setmode.o stat_flags.o \
	pwcache.o getopt_long.o

LINK=   = $(CCLD) $(CFLAGS) $(LDFLAGS) -o $@
COMPILE = $(CC) $(CPPFLAGS) $(CFLAGS)

all: nbtypes.h ${LIB}

.c.o: nbtypes.h
	$(COMPILE) $(DEFS) -c $< -o $@

${LIB}: ${OBJS}
	${AR} cr $@ ${OBJS}
	${RANLIB} $@

nbtypes.h: bits
	./bits nbtypes.h

bits: bits.c
	${CC} -o bits bits.c

install:
	${INSTALL} -m 555 ${LIB} ${prefix}/lib
	${RANLIB} ${prefix}/lib/${LIB}
	${INSTALL} -m 755 -d ${prefix}/include/libnbcompat
	${INSTALL} -m 444 extern.h ${prefix}/include/libnbcompat
	${INSTALL} -m 444 err.h ${prefix}/include/libnbcompat
	${INSTALL} -m 444 ftpglob.h ${prefix}/include/libnbcompat
	${INSTALL} -m 444 fts.h ${prefix}/include/libnbcompat
	${INSTALL} -m 444 getopt.h ${prefix}/include/libnbcompat
	${INSTALL} -m 444 md5.h ${prefix}/include/libnbcompat
	${INSTALL} -m 444 mtree.h ${prefix}/include/libnbcompat
	${INSTALL} -m 444 namespace.h ${prefix}/include/libnbcompat
	${INSTALL} -m 444 nbcompat.h ${prefix}/include/libnbcompat
	${INSTALL} -m 444 nbtypes.h ${prefix}/include/libnbcompat
	${INSTALL} -m 444 pack_dev.h ${prefix}/include/libnbcompat
	${INSTALL} -m 444 pwcache.h ${prefix}/include/libnbcompat
	${INSTALL} -m 444 rmd160.h ${prefix}/include/libnbcompat
	${INSTALL} -m 444 sha1.h ${prefix}/include/libnbcompat
	${INSTALL} -m 444 sha2.h ${prefix}/include/libnbcompat
	${INSTALL} -m 444 stat_flags.h ${prefix}/include/libnbcompat
	${INSTALL} -m 444 util.h ${prefix}/include/libnbcompat
	${INSTALL} -m 444 vis.h ${prefix}/include/libnbcompat

clean:
	rm -f *.a *.o bits nbtypes.h

distclean: clean
	rm -f Makefile config.h config.log config.status configure.lineno

